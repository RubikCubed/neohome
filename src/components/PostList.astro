---
import { getCollection } from "astro:content";

// const blogEntries = (await getCollection("blog")).filter((data) => {
//     const draft = (() => {
//         if ("draft" in data) {
//             if (typeof data.draft === "boolean") {
//                 return data.draft;
//             }
//         }
//         return undefined;
//     })();

//     console.log(`${data.id} draft=${draft}`);

//     if (import.meta.env.DEV === true) {
//         return true;
//     } else if (draft === true) {
//         return false;
//     } else {
//         return true;
//     }
// });

const blogEntries = (await getCollection("blog"))
    .sort((a, b) => {
        if (a.data.pubDate === undefined || b.data.pubDate === undefined) {
            return 0;
        }

        return a.data.pubDate.getSeconds() - b.data.pubDate.getSeconds();
    })
    .filter((elem) => {
        if (elem.data.draft === true) {
            return false;
        } else {
            return true;
        }
    });
---

<h1>Post List</h1>

<ul>
    {
        blogEntries.map((item) => (
            <li>
                <a href={`/blog/${item.slug}`}>{item.slug}</a>
            </li>
        ))
    }
</ul>
